var Lithium=function(){},_li=new Lithium;!function(){"use strict";return _li}(),Lithium.prototype.core={},Lithium.prototype.fn={},Lithium.prototype.plugins={},Lithium.prototype.apps={},Lithium.prototype.define=function(a){"use strict";var b,c=this.define.getReference,d=0,e={};if("object"==typeof a)for(d;d<a.length;d+=1)b=a[d],e[b]=c(b),e[b].set("name",b);else b=a,e=c(b),e.set("name",b);return e},Lithium.prototype.define.getReference=function(string){"use strict";return eval("_li.apps."+string)},Lithium.prototype.fn.curry=function(a,b){"use strict";var c=this;return b.length>1?c.curry(a(b.shift()),b):a(b[0])},Lithium.prototype.plugins.regex=function(a){"use strict";var b,c,d;return b=function(b){return c(a,b)},c=function(a,b){return function(c){return d(a,b,c)}},d=function(a,b,c){return function(d){return d.replace(new RegExp(b,a),c)}},b},Lithium.prototype.plugins.regex.hashBangHash=function(a){"use strict";var b=this;return b.curry(Lithium.prototype.plugins.regex,["g","#!#","/",a])}.bind(Lithium.prototype.fn),Lithium.prototype.core.init=function(a,b,c){"use strict";var d=this;d.resolve(a),d.getPaths(a),d.loader(c),window.onload=function(){d.fireEvent(b.event,b.data)}}.bind(Lithium.prototype.core),Lithium.prototype.core.addListener=function(a,b,c){"use strict";var d=this;d.eventListeners[a]||(d.eventListeners[a]={}),b?d.eventListeners[a][b]=c:d.eventListeners[a]=c}.bind(Lithium.prototype.core),Lithium.prototype.core.eventListeners={},Lithium.prototype.core.fireEvent=function(a,b){"use strict";var c,d=this,e=d.eventListeners[a],f={};if("object"==typeof e)for(c in e)e.hasOwnProperty(c)&&e&&e[c]&&(f[c]=e[c](b));return"function"==typeof e&&(f=e(b)),f}.bind(Lithium.prototype.core),Lithium.prototype.core.getPaths=function(a){"use strict";var b=this.core,c=this.plugins,d=!1,e="js",f=function(a,e){var g,h=!1;if("object"==typeof a){for(g in a)a.hasOwnProperty(g)&&(h=!0,d&&(e=e.slice(0,e.lastIndexOf("#!#"))),a[g]&&"object"==typeof a[g]?(d=!1,"items"!==g&&(e+="#!#"+g,b.subModules.push(c.regex.hashBangHash(e)+".js"))):a.items||(d=!0),f(a[g],e));h||(d=!0)}};f(a,e)}.bind({core:Lithium.prototype.core,plugins:Lithium.prototype.plugins}),Lithium.prototype.core.loader=function(a){"use strict";var b,c=this,d=document.querySelector("body"),e=c.subModules;for(var f in e)e.hasOwnProperty(f)&&(b=document.createElement("script"),b.setAttribute("src",a+e[f]),d.appendChild(b))}.bind(Lithium.prototype.core),Lithium.prototype.core.request=function(a,b){"use strict";var c,d=this.publish;window.XMLHttpRequest&&(c=new XMLHttpRequest),c&&(c.onreadystatechange=function(){4===c.readyState&&200===c.status&&d(a,c.responseText)},c.open("GET",b,!0),c.send())}.bind({publish:Lithium.prototype.core.fireEvent}),Lithium.prototype.core.properties={},Lithium.prototype.core.properties.set=function(a,b){"use strict";this.prototype.properties||(this.prototype.properties={}),b||(b=null),this.prototype.properties[a]=b},Lithium.prototype.core.properties.get=function(a){"use strict";return this.prototype.properties?this.prototype.properties[a]:null},Lithium.prototype.core.provider=function(a,b){"use strict";var c,d=this.subscribe,e=this.publish,Provider=function(a,b){this.src=b,this.name=a,this.event=a+".requestOK",d(a+".add",!1,this.add.bind(this)),d(a+".update",!1,this.update.bind(this)),d(a+".remove",!1,this.remove.bind(this)),d(this.event,!1,this.requestOK.bind(this))};Provider.prototype={requestCreate:function(a){e(this.event,a)},requestOK:function(a){var b=JSON.parse(a);e(this.name+".ready",b)},add:function(a){this.requestCreate(JSON.stringify(a))},update:function(a){this.requestCreate(JSON.stringify(a))},remove:function(a){this.requestCreate(JSON.stringify(a))}},c=function(){return new Provider(a,b)},d(a+".create",!1,c)}.bind({subscribe:Lithium.prototype.core.addListener,publish:Lithium.prototype.core.fireEvent,request:Lithium.prototype.core.request}),Lithium.prototype.core.model=function(a,b,c){"use strict";var d,e,f,g=this.subscribe,h=this.publish,Model=function(a,b,c,d){this.schema=a,this.providerName=b,this.provider=h(b+".create"),this.name=c,g(this.providerName+".ready",!1,this.added.bind(this)),h(this.providerName+".add",d)},i={};Model.prototype={update:function(b){for(var c in b)b.hasOwnProperty(c)&&(this[c]=b[c]);h(a+".ready",b),h(this.providerName+".update",this)},remove:function(){return i[this.__id]=null,h(this.providerName+".remove",this.__id),delete i[this.__id],null},added:function(a){var b=this.schema;for(var c in b)b.hasOwnProperty(c)&&(this[c]=a[c]);i[a.__id]=this,h(this.name+".ready",a)}},d=function(d){return new Model(b,c,a,d)},e=function(a){return i[a]},f=function(){return i},g(a+".add",!1,d),g(a+".read",!1,e),g(a+".readAll",!1,f)}.bind({subscribe:Lithium.prototype.core.addListener,publish:Lithium.prototype.core.fireEvent}),Lithium.prototype.core.presenter=function(a,b,c,d,e){"use strict";var f,g=this.subscribe,h=this.request,i=this.plugins,j=this.publish,k=this.fn,l=k.curry(i.regex,["g"]),Presenter=function(b,c,d){this.presenter=null,this.target=d,this.model=j(b+".add",c),this.classes=["js__presenter","js__presenter__"+a],g(a+".getView",d,this.loaded.bind(this)),g(b+".ready",d,this.updateData.bind(this)),g(a+".ready",d,this.render.bind(this))},m={};Presenter.prototype={load:function(){var c=a+".getView";h(c,b)},loaded:function(b){this.presenter=b,this.template=b,this.updateData(this.model),j(a+".ready",this.target)},updateData:function(a){var b=this.template;for(var c in a)a.hasOwnProperty(c)&&a[c]&&(b=k.curry(l,["{{"+c+"}}",a[c],b]));b=k.curry(l,["{{(.*)}}","",b]),this.presenter=b,this.updateView()},updateView:function(){var a;for(a in m)m.hasOwnProperty(a)&&(m[a].innerHTML="");for(a in m)if(m.hasOwnProperty(a)){var b=this.createNode();m[a].appendChild(b)}},render:function(a){if(this.presenter){var b=document.querySelectorAll(a),c=0;for(c;c<b.length;c+=1){var d=this.createNode();b[c].appendChild(d),m[this.__id]=b[c],this.__id+=1}}},createNode:function(){var a=document.createElement("div"),b=0;for(b;b<this.classes.length;b+=1)a.classList.add(this.classes[b]);return a.innerHTML=this.presenter,a},__id:0},f=function(){return new Presenter(c,d,e)},g(a+".add",!1,f)}.bind({subscribe:Lithium.prototype.core.addListener,publish:Lithium.prototype.core.fireEvent,request:Lithium.prototype.core.request,plugins:Lithium.prototype.plugins,fn:Lithium.prototype.fn}),Lithium.prototype.core.removeListener=function(a,b){"use strict";var c=this;delete c.eventListeners[a][b]}.bind(Lithium.prototype.core),Lithium.prototype.core.construct=function(a){"use strict";a||(a="default");var Module,Model,Presenter,Provider,b=this.subscribe,c=this.publish,d=this.unSubscribe,e=this.createPresenter,f=this.createModel,g=this.createProvider,h=this.setProperty,i=this.getProperty,j=null;return Module=function(){},Model=function(){},Presenter=function(){},Provider=function(){},"default"===a&&(Module.prototype.set=h.bind(Module),Module.prototype.get=i.bind(Module),Module.prototype.subscribe=b,Module.prototype.publish=c,Module.prototype.unSubscribe=d,j=new Module),"model"===a&&(Model.prototype.set=h.bind(Model),Model.prototype.get=i.bind(Model),Model.prototype.subscribe=b,Model.prototype.publish=c,Model.prototype.createModel=f.bind(Model),j=new Model),"presenter"===a&&(Presenter.prototype.set=h.bind(Presenter),Presenter.prototype.get=i.bind(Presenter),Presenter.prototype.subscribe=b,Presenter.prototype.publish=c,Presenter.prototype.createPresenter=e.bind(Presenter),j=new Presenter),"provider"===a&&(Provider.prototype.set=h.bind(Provider),Provider.prototype.get=i.bind(Provider),Provider.prototype.subscribe=b,Provider.prototype.publish=c,Provider.prototype.createProvider=g.bind(Provider),j=new Provider),j}.bind({subscribe:Lithium.prototype.core.addListener,publish:Lithium.prototype.core.fireEvent,unSubscribe:Lithium.prototype.core.removeListener,createModel:Lithium.prototype.core.model,createPresenter:Lithium.prototype.core.presenter,createProvider:Lithium.prototype.core.provider,setProperty:Lithium.prototype.core.properties.set,getProperty:Lithium.prototype.core.properties.get}),Lithium.prototype.core.resolve=function(a){"use strict";var b=this.apps,c=this.construct,d=function(a,b){var e="",f={};for(var g in a)a.hasOwnProperty(g)&&(e=a[g].type,f=a[g].items,b.prototype||(b[g]=c(e)),d(f,b[g]))};d(a,b)}.bind({apps:Lithium.prototype.apps,construct:Lithium.prototype.core.construct}),Lithium.prototype.core.subModules=[];